import{_ as f}from"./C1FmrZbK.js";import{w as d}from"./bzQUwULm.js";const i="wss://conductor.mycelix.net",_=5e3,p=1e4,o=d("disconnected"),c=d(null);let n=null,a=null,u=null,r=null;async function y(){if(r)return!0;try{return r=(await f(()=>import("./14ucSnzm.js"),[],import.meta.url)).AppWebsocket,!0}catch(e){return console.error("[Conductor] Failed to load @holochain/client:",e),!1}}async function C(){if(n)return!0;if(o.set("connecting"),c.set(null),!await y()||!r)return o.set("error"),c.set("Failed to load Holochain client library"),!1;try{return n=await r.connect(i),o.set("connected"),console.log("[Conductor] Connected to",i),g(),!0}catch(t){const l=t instanceof Error?t.message:"Unknown error";return o.set("error"),c.set(l),console.error("[Conductor] Connection failed:",l),s(),!1}}function s(){a||(a=setTimeout(async()=>{a=null,console.log("[Conductor] Attempting reconnect..."),await C()},_))}function g(){u||(u=setInterval(async()=>{if(!n){o.set("disconnected"),s();return}try{await n.appInfo(),o.set("connected")}catch{o.set("error"),n=null,s()}},p))}async function m(e){if(!n)return console.warn("[Conductor] Not connected, cannot call zome"),null;try{return await n.callZome(e)}catch(t){return console.error("[Conductor] Zome call failed:",t),null}}async function E(){const e=await m({role_name:"mycelix-core",zome_name:"matl",fn_name:"get_recent_alerts",payload:{limit:50}});return e?e.map(t=>({id:t.id,severity:t.severity,message:t.message,source:t.source,timestamp:t.timestamp,resolved:t.resolved})):[]}async function T(){const e=await m({role_name:"mycelix-core",zome_name:"bridge",fn_name:"get_bridge_stats",payload:null});return{messageCount:(e==null?void 0:e.message_count)??0,crossHappQueries:(e==null?void 0:e.cross_happ_queries)??0}}function v(){return n!==null}export{m as a,o as b,C as c,T as d,E as g,v as i};
